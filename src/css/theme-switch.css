/* REFS:
   https://codepen.io/miriamsuzanne/pen/rNbeXPe
   1. https://www.smashingmagazine.com/2024/03/setting-persisting-color-scheme-preferences-css-javascript/
   2. https://www.smashingmagazine.com/2022/05/accessible-design-system-themes-css-color-contrast/
   3. https://www.smashingmagazine.com/2023/01/creating-high-contrast-design-system-css-custom-properties/ */

/* TODO: Add support for theme switching
          that does not rely on scripting.
          Go → props/media.css */
/* –OR–
    Simplify the code with the light-dark() function.
    → https://web.dev/articles/light-dark
*/
/* @supports (color-scheme: light dark) and
          (color: light-dark(#222, #fff))
{ :root {
    --foreground: light-dark(#333, #fafafa);
    --background: light-dark(#e4e4e4, #121212);
    --accent: light-dark(hotpink, lime);
    color-scheme: light dark;
  }
} */

/* :root:has(input[name="color-scheme"][value="light dark"]:checked) {
  color-scheme: light dark;
} */

:root {
  &:has(input[part="toggleCheckbox"]:checked) {
    color-scheme: light;
  }

  &:has(input[part="toggleCheckbox"]:not(:checked)) {
    color-scheme: dark;
  }
}

/* noscript { display:contents } */
theme-switch {
  :host {
    contain:content;
    display:block
  }

  form {
    color:inherit;
    background:transparent
  }

  legend{
    padding:0;
    margin-block-end:0.5rem;
    font:var(--theme-switch-legend-font,inherit)
  }

  input,label { cursor:pointer }

  input {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: 0;
    overflow: hidden;
    clip: rect(0 0 0 0);
    white-space: nowrap;
    pointer-events: none;
    border: 0;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    clip-path: inset(100%);
    &:focus:not(:focus-visible) + label { outline:0 }

    &:focus-visible + label {
      --theme-switch-border-color: var(--accent);
    }

    & + label {
      position: relative;
      display: inline-block;
      padding: .1ch;
      vertical-align: top;
      border: 1px solid var(--theme-switch-border-color, transparent);
      border-radius: 50%;
      transition:
        0s 300ms border-color ease-in-out,
        0s 300ms filter ease-in-out;
    }
  }
}

/*
label::after {
  content: '';
  display: inline-block;
  background-size: var(--theme-switch-icon-size, 1rem);
  background-repeat: no-repeat;
  width: var(--theme-switch-icon-size, 1rem);
  height: var(--theme-switch-icon-size, 1rem);
  filter: var(--theme-switch-icon-filter, none);
  vertical-align: middle;
  transition: filter 200ms ease-in-out;
}
[part="darkLabel"]::after {
  background-image: var(--theme-switch-dark-icon, var(--icon-outlined);
}
[part="lightLabel"]::after {
  background-image: var(--theme-switch-light-icon, var(--icon-filled));
}
[part="toggleLabel"]::after {
  background-image: var(--theme-switch-icon, var(--icon));
} */

@media (hover: hover) {
  label:hover { filter: brightness(120%); }
}

[part="toggleLabel"] > svg {
  inline-size: 100%;
  block-size: 100%;
  stroke-linecap: round;
}

.sun-and-moon > :is(.moon, .sun, .sun-beams) {
  transform-origin: center center;
}

.sun-and-moon > :is(.moon, .sun) {
  fill: var(--theme-switch-icon-fill);
}

[part="toggleLabel"]:is(:hover, :focus-visible) .sun {
  fill: var(--theme-switch-icon-fill-hover);
}

[part="toggleLabel"] .sun-beams {
  stroke: var(--theme-switch-icon-fill);
  stroke-width: 2px;
}

[part="toggleLabel"]:is(:hover, :focus-visible) .sun-beams {
  stroke: var(--theme-switch-icon-fill-hover);
}

@media (prefers-reduced-motion: no-preference) {
  .sun-and-moon > .sun {
    transition:
      transform
        var(--sun-duration, .5s)
        var(--sun-easing, cubic-bezier(.5, 1.25, .75, 1.25));
    transform: scale(var(--sun-sx, 1));
  }

  .sun-and-moon > .sun-beams {
    opacity: var(--beams-a, 1);
    transition:
      transform
        var(--beams-duration, .5s)
        cubic-bezier(.5, 1.5, .75, 1.25),
      opacity
        var(--beams-duration, .5s)
        cubic-bezier(.25, 0, .3, 1);
    transform: rotateZ(var(--beams-r, 0));
  }

  .sun-and-moon > .moon > circle {
    transition: transform var(--moon-duration, .25s) cubic-bezier(0,0,0,1);
    transition-delay: var(--moon-delay, 0s);
    transform: translateX(var(--moon-tx, 0));
  }
}

@media (prefers-color-scheme: dark) {
  [part="lightLabel"],
  [part="darkLabel"] {
    /* … */
  }

  [part="toggleLabel"] {
    --moon-duration: .5s;
    --moon-delay: .25s;
    --beams-duration: .15s;
    --sun-easing: cubic-bezier(.25, 0, .3, 1);
    --sun-duration: .25s;
    --sun-sx: 1.75;
    --moon-tx: -7px;
    --beams-a: 0;
    --beams-r: -25deg;
  }
}

@media (prefers-color-scheme: light) {
  [part="toggleLabel"] {
    --moon-duration: .25s;
    --moon-delay: 0s;
    --beams-duration: .5s;
    --sun-easing: cubic-bezier(.5, 1.25, .75, 1.25);
    --sun-duration: .5s;
    --sun-sx: 1;
    --moon-tx: 0;
    --beams-a: 1;
    --beams-r: 0deg;
  }
}
