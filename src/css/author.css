body:where([data-id=homepage]) { /* visual tweaks */
  --sketch-bg: var(--background);
  --sketch-bg: light-dark(var(--clear-medium), var(--riso-black));

  > footer {
    --surface: var(--background);
    --gradient: var(--lin-gradient-voygb);

    padding: 1ch 2ex;
    text-shadow: 0 1px 1px hsl(0 0% 0% / 30%);
    background:
      linear-gradient(
        var(--surface),
        var(--surface)) padding-box,
        var(--gradient) border-box;
    border: .125cqi transparent solid;
    border-radius: 1ch;
    box-shadow: 0 1rem 1rem -1rem hsl(0 0% 0% / 90%);
  }

  > footer :where([itemprop=name]) {
    -webkit-appearance: none;
    appearance: none;
    max-inline-size: 12ch;
    padding-inline: .5ch;
    border-inline: 1px;
    border-image:
      linear-gradient(
        transparent,
        var(--accent),
        transparent
      )
      1 / 1px;
    caret-color: var(--accent);
    font-variation-settings: "wght" 200, "ital" 1;
  }

  :where([aria-labelledby=contact]) {
    --_bg: light-dark(hsl(var(--blue-light)), hsl(var(--blue)));

    container-type: inline-size;
    padding: var(--gutter);
    margin-inline: var(--gutter);
    background-color: var(--_bg, var(--apple-blue));
    border-radius: var(--border-radius-2);

    .keyline {
      min-inline-size: calc(100cqi + var(--gutter)*2);
      margin-inline: calc(var(--gutter)*-1);
      gap: .5ch;
    }
  }
  @container (20rem <= width < 32.5rem) {
    .keyline {
      --opsz: 20;

      &::after,
      &::before {
        --border-imgsrc: repeating-linear-gradient(
          -45deg,
          var(--neon-lime) 0 2px,
          var(--neon-purple) 0 4px,
          var(--neon-pink) 0 6px,
          color-mix(in oklab, var(--accent), var(--_bg) 50%) 0 12px
        );
      }
    }
  }

  :where([class*=tag]) {
    /* overrides */
    inset-inline-end: unset;
    inset-block-end: unset;
    font-size: .75rem;
    letter-spacing: -0.008em; /* 45×18 ~ 5:2 ~ 100×40 */
    transform: translate(
      calc(2/5 * 40 * -1%),
      calc(2/5 * 100 * -1%)
    );
    font-feature-settings: "c2sc" 1;
  }

  /* TODO https://codepen.io/hexagoncircle/pen/YjXowe */
  :where([class*=keyline]) {
    letter-spacing: calc(var(--letter-spacing-3)*-1);

    &::before,
    &::after {
      --to-left: linear-gradient(-90deg, var(--c1), 33.333%, var(--c2));
      --to-right: linear-gradient(90deg, var(--c1), 33.333%, var(--c2));
      --c1: color-mix(in oklab, var(--accent), var(--_bg) 80%);
      --c2: var(--accent);
      border-style: solid;
      border-width: var(--line-md) 0 0;
      border-image-source: var(--border-imgsrc, var(--to-left));
      border-image-slice: 1;
      border-image-width: 1;
    }

    :where([data-theme-style=light] &) {
      &::after { --border-imgsrc: var(--to-right); }
    }

    :where([data-theme-style=dark] &) {
      &::before { --border-imgsrc: var(--to-right); }
    }
  }
}

/* TODO */
/* @layer custom-cursor {
  .custom-cursor {
    position: fixed;
    top: calc(var(--y, -100) * 1px);
    left: calc(var(--x, -100) * 1px);
    width: 24px;
    height: 24px;
    pointer-events: none;
    cursor: none;
    background: white;
    border-radius: 50%;
    translate: -50% -50%;
  }
}

@layer custom-cursor.preview {
  :root:has(.has-preview:hover) .preview {
    --intent: 1;
  }

  .preview {
    position: absolute;
    bottom: 0;
    left: 50%;
    display: inline-block;
    width: 24px;
    height: 24px;
    pointer-events: none;
    cursor: none;
    background: hsl(
      0 calc(var(--active) * 100%) calc(100% - (var(--active) * 50%)) / 1
    );
    border-radius: 50%;
    opacity: var(--intent, 0);
    transition: opacity 0.2s, clip-path 0.2s;
    translate: -50% 0;
  }

  li:hover {
    opacity: 1;
  }

  li:has(~ li:hover),
  li:hover ~ li {
    opacity: 0.2;
  }

  :root:has(ol li:hover) .preview {
    --active: 1;
  }

  :root:has(ol li:nth-of-type(1):hover) .preview__img img:nth-of-type(1),
  :root:has(ol li:nth-of-type(2):hover) .preview__img img:nth-of-type(2),
  :root:has(ol li:nth-of-type(3):hover) .preview__img img:nth-of-type(3) {
    --show: 1;
  }

  :root:has(ol li:hover) .preview__img {
    clip-path: inset(0 0 0 0 round 0);
  }

  .preview__img {
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 100px;
    height: 100px;
    background: white;
    border: 1px solid white;
    transition: translate 0.2s, clip-path 0.2s;
    translate: -50% calc(var(--active, 0) * -2rem);
    clip-path: inset(calc(100% - 12px) calc(50% - 6px) 0 calc(50% - 6px) round 100px);
  }

  .preview__img img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    opacity: var(--show, 0);
    object-fit: cover;
  }
} */

/* CSS Noise Gradient (shadow)
   → https://codepen.io/cjimmy/pen/XWRQPep */
@layer {
  :has(>.sketch) {
    background: var(--sketch-bg, canvas);
  }

  svg > text {
    --_size: 12.5rem;
    --_dy: calc(var(--size) * .35);
    --_variations:
      "opsz" 48,
      "wght" 500,
      "ital" 1;
    --_features:
      "kern" on,
      "rvrn" off,
      "liga" on,
      "dlig" on,
      "smcp" on;
  }

  .sketch {
    --_noise: url("https://grainy-gradients.vercel.app/noise.svg");
    inline-size: 250px;
  }

  .ball {
    z-index: 1;
    inline-size: 250px;
    overflow: hidden;
    border-radius: calc(var(--big-int)*1px);
    aspect-ratio: var(--ratio-1);

    & [class*=light] {
      inline-size: 100%;
      block-size: 100%;
      background: radial-gradient(circle at 67% 30%, lightsalmon, crimson);
      mix-blend-mode: multiply;
    }

    & [class*=shadow] {
      block-size: 100%;
      background-image:
        radial-gradient(circle at 65% 35%, var(--trn), mediumblue),
        var(--_noise);
      filter: contrast(120%) brightness(900%);
    }
  }

  .ground {
    inset-block-end: -10px;
    inset-inline-start: -65%;
    inline-size: 150%;
    block-size: 140px;
    transform: rotateZ(7deg);
    mix-blend-mode: multiply;

    & [class*=shadow] {
      inline-size: 95%;
      block-size: 140px;
      background:
        radial-gradient(ellipse at 70%, navy, var(--trn)),
        var(--_noise);
      filter: contrast(150%) brightness(700%);
      border-radius: 50%;
    }
  }
}

@layer layouts.header {
  .page__header {
    background:
      linear-gradient(to bottom,
        hsl(var(--honeydew) / .15),
        33.333%,
        hsl(var(--honeydew) / 0) 75%
      );
    backdrop-filter: brightness(80%);
  }
}

@layer layouts.nav {
  .nav {
    container-name: nav;
    container-type: inline-size;

    :where([data-theme-style=light]) & {
      backdrop-filter: blur(var(--blur-os));
    }

    :where([data-theme-style=dark]) & {
      /* Refs
         https://codepen.io/argyleink/pen/rNxrPMq
         https://codepen.io/argyleink/pen/GRZoQLB
      */
      background: linear-gradient(127deg,
        hsl(var(--tn-lemon-tonic) / .75),
        calc(100% - (100% / 3 * 2)),
        hsl(var(--tn-pink-glo) / .5),
        calc(100% - (100% / 3 * 1) + 25%),
        hsl(var(--tn-atomic-blue) / .25)
      );
      backdrop-filter: var(--smooth-glass);
    }
  }

  .nav__items {
    display: flex;
    flex-direction: column;
  }

  @container (orientation: landscape) { /* TODO */
    /* .nav__items {
      flex-direction: row;
      gap: 1.5rem;
    } */
  }

  .nav__link {
    min-block-size: var(--min-touch-target);
    font-size: clamp(1.5rem, 2.5vw + 1rem, 3rem);
    line-height: normal;
  }
}

@layer theme.support.page {
  body:has(> aside > nav) {
    display: grid;
    grid: [stack] 1fr / min-content [stack] 1fr;
    & > * { grid-area: stack; }
    & main { contain: layout; }
  }

  h1 {
    max-inline-size: min(40ch, 80vw);
    line-height: 1cap;
  }

  article {
    padding-inline: var(--gutter);
  }
}

@layer utilities.grid {
  .cols-triptych {
    grid-template-rows: 1fr auto;
    grid-template-columns: repeat(auto-fit, minmax(0, 1fr));
    align-items: center;
    padding-block: var(--spacer-4x);
    padding-inline: var(--gutter);
    margin-block: calc(var(--spacer-2x) * -1);
    column-gap: 1cqi;
    row-gap: 1cqi;

    & img {
      /* object-fit: contain; */
      object-fit: cover !important;
      min-block-size: 100%;
    }

    & > *:where(:not(figcaption, blockquote, q)) {
      grid-column: var(--line);
      grid-row: 1;
      clip-path: inset(0);
    }

    & > :where(figcaption, (blockquote, q):where([cite])) {
      grid-column: 1 / span 5;
      grid-row: 2;
      grid-template-rows: inherit;
      row-gap: 1cqi;
      color: hsl(var(--paper-1) / .88);

      > :first-child {
        --_size: 1.384em;
        grid-column: 2 / 5;

        display: grid;
        grid-template-columns: minmax(auto, 0) 1fr minmax(auto, 0);
        column-gap: var(--_size);
        align-items: baseline;
        margin-inline: calc(var(--_size) * -1);

        hyphens: auto;
        line-height: var(--lh-eighty);
        text-wrap: pretty;
        quotes: "\00AB" "\00BB" "\201E" "\201C";

        &::before, &::after {
          font-size: var(--_size);
          opacity: .5;
        }

        &::before { justify-self: start; }
        &::after  { justify-self: end; }
      }

      > :last-child {
        grid-column: 3 / 5;

        font-style: normal;
        text-align: right;
        font-feature-settings: "onum" 1;
      }
    }

    & > :where(
      :nth-of-type(1),
      :nth-of-type(3)
    ) {
      &:is(div, img, svg) {
        /* aspect-ratio: 3 / 5; */
        aspect-ratio: 7 / 12 !important; /* 700×1200 */
      }
    }

    & > :where(
      :nth-of-type(2)
    ) {
      --line: 2 / 5;

      &:is(div, img, svg) {
        /* aspect-ratio: 3 / 2; */
        aspect-ratio: 7 / 5 !important; /* 1680×1200 */
      }
    }
  }

  ul :where(figure, picture:not(+picture)) {
    overflow: hidden;
    aspect-ratio: 3 / 2;

    & > img {
      /* object-fit: contain; */
      inline-size: 100%;
      block-size: 100%;
      margin: auto;
    }
  }

  ul :where(figure:has(figcaption)) {
    display: grid;
    grid-template-rows: 1fr auto;
    margin: 0;
    font: inherit;

    & > img {
      grid-row: 1 / -1;
      grid-column: 1;
    }

    & > figcaption {
      font-family: inherit;
      font-size: 1rem;
    }
  }
}

/* TODO: Плавные переходы с помощью View Transition API */
/* https://developer.chrome.com/docs/web-platform/view-transitions
   https://developer.chrome.com/blog/view-transitions-update-io24 */

@layer theme {
  body { --var-serif: Roslindale; }

  .vf {
    font-variation-settings:
      "opsz" var(--opsz, 11),
      "wght" var(--wght, 400),
      "ital" var(--ital, 0);
  }
}

@layer theme.color.ui-adjust {
  :where(html[data-theme-style=light]) {
    --bg-hsl: var(--warm-white-3);
  }

  :where(html[data-theme-style=dark]) {
    /* --accent-hsl: var(--coral); */
    --bg-hsl: var(--green-dark);
    --fg-hsl: var(--honeydew);
  }
}

@layer theme.color.palettes {
  /* https://www.sherwin-williams.com/en-us/color/color-collections/colormix-forecast/2024 */

  :where(html) {
    --green-dark: var(--sw-night-watch);
    --blue-light: var(--sw-upward, powderblue); /* SW COTY 2024 */
    --blue: var(--sw-georgian-bay);
    --honeydew: var(--sw-honeydew, honeydew); /* SW COTM June */
    --maroon: var(--sw-carnelian, maroon);
  }
}

@layer theme.color.swatches {
  :where(html) {
    /* https://en.wikipedia.org/wiki/Snow_White_design_language
       https://www.landsnail.com/apple/local/design/intro.html
       https://apple.fandom.com/wiki/List_of_Apple_product_colors
       https://www.schemecolor.com/apple-rainbow-logo.php
    */
    --apple-beige: #bfbb98; /* PANTONE 453 C */
    --apple-beige: #c4c0aa; /* PANTONE 14–0105 TPG */
    --apple-beige: #cacac8; /* PANTONE Cool Gray 2 U */
    --apple-blue: #0095B6;

    /* TODO: Add RISO inks palette */
    --riso-black: hsl(30deg 3% 13%); /* #21201F */
    --clear-medium: var(--off-white-5);
  }

  /* @layer riso {} */
}

@layer reset {
  /* picture:has(> img) { display: contents } */
}
